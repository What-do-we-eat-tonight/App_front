import{E as t,u as e,G as s,x as o,o as n,d as a,w as u,c as i,y as l,F as c,a as r,b as m,r as d,i as h,t as f,p as v}from"./index.8f27103f.js";import{_ as g}from"./uni-card.9cdbe16e.js";import{_ as p,r as _}from"./uni-app.es.117eeecc.js";import{_ as b}from"./uni-easyinput.f8a8f877.js";import{_ as y}from"./u-button.b4b9cb03.js";import"./uni-icons.414bc032.js";var E=p({components:{},data:()=>({items:[],value:"",timeOutEvent:0,dele:!1,num:-1}),methods:{getMore(){t({title:"点击查看更多",icon:"none"})},async getitems(){let t={sno:e("login_id"),cno:e("cno")};await this.$u.post("/student_user/evaluation",t).then((t=>{this.items=t,console.log(t)})),console.log(this.items)},async send(){let t={sno:e("login_id"),cno:e("cno"),evaluation_text:this.value,count:1};console.log(t),await this.$u.post("/student_user/putEvaluation",t),this.$u.toast("发送成功"),this.value="",this.getitems()},gtouchstart(t){var e=this;return this.timeOutEvent=setTimeout((function(){e.longPress(t)}),500),!1},showDeleteButton(t){return clearTimeout(this.timeOutEvent),0!=this.timeOutEvent&&console.log("点击但未长按"),!1},gtouchmove(){clearTimeout(this.timeOutEvent),this.timeOutEvent=0},async longPress(t){this.timeOutEvent=0;var o=this;o.num=t,console.log(o.num),s({title:"确认删除评价",content:"请确认是否删除这条评价",success:async function(t){if(t.confirm){o.dele=!0;let t={eva_no:o.num,user_id:e("login_id")};console.log(t),await o.$u.post("/student_user/delete_eva",t),o.$u.toast("删除成功")}else t.cancel}})}},onLoad(){this.getitems()},onPullDownRefresh(){console.log("refresh"),this.getitems(),setTimeout((function(){o()}),1e3)},onBackPress(t){console.log(t),"backbutton"==t.from&&this.$u.route("/pages/class/class")}},[["render",function(t,e,s,o,p,E){const T=v,w=_(d("uni-card"),g),O=_(d("uni-easyinput"),b),j=_(d("u-button"),y),x=h;return n(),a(x,{class:"container",blurEffect:"light"},{default:u((()=>[(n(!0),i(c,null,l(p.items,((t,s)=>(n(),a(w,{isFull:"","is-shadow":!1,onTouchstart:e=>E.gtouchstart(t.evaluation_num),onTouchmove:e[0]||(e[0]=t=>E.gtouchmove()),onTouchend:e=>E.showDeleteButton(t)},{default:u((()=>[r(T,null,{default:u((()=>[m(f(t.C_evaluation_text),1)])),_:2},1024)])),_:2},1032,["onTouchstart","onTouchend"])))),256)),r(w,null,{default:u((()=>[r(O,{type:"textarea",modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=t=>p.value=t),placeholder:"请输入课程评价"},null,8,["modelValue"])])),_:1}),r(j,{onClick:E.send,type:"primary"},{default:u((()=>[m("发送")])),_:1},8,["onClick"])])),_:1})}],["__scopeId","data-v-2440526e"]]);export{E as default};
