import{u as t,s as e,G as s,x as i,o,c as n,F as a,y as u,a as l,w as c,b as r,r as _,d,e as h,t as m,i as q,p}from"./index.8f27103f.js";import{_ as f}from"./uni-tag.42261c69.js";import{_ as g,r as k}from"./uni-app.es.117eeecc.js";import{_ as y}from"./uni-icons.414bc032.js";import{_ as b}from"./uni-card.9cdbe16e.js";import{_ as w}from"./uni-easyinput.f8a8f877.js";import{_ as v}from"./u-button.b4b9cb03.js";var $=g({components:{},data:()=>({ques_avatar:"/static/ques2.png",ans_avatar:"/static/ans2.png",questions:[],value:"",answers1:[],answers2:[],like_ques:[],like_ans:[],state:!1,new_ques:""}),methods:{async send(){let e={cno:t("cno"),question:this.new_ques,sno:t("login_id"),time:"2022"};await this.$u.post("student_user/PutQuestion",e),this.$u.toast("发布问题成功"),this.new_ques="",this.getQuestions()},async getQuestions(){let e={cno:t("cno"),user_id:t("login_id")};console.log(e),await this.$u.post("student_user/GetQuestion",e).then((t=>{this.questions=t,this.like_ques.push({})})),console.log(this.questions)},async like_it(e,s){this.questions[s].hasliked=!0,this.questions[s].q_like++;let i={sequence_num:e,tno:t("login_id")};await this.$u.post("teacher_user/question_thumbs",i),this.$u.toast("点赞成功")},async dislike_it(e,s){this.questions[s].hasliked=!1,this.questions[s].q_like--;let i={sequence_num:e,tno:t("login_id")};console.log(i),await this.$u.post("teacher_user/question_thumbs_cancel",i),this.$u.toast("取消点赞成功")},to_answer(t){e("q_num",t),this.$u.route({url:"pages/forum/answer_teacher",type:"to"})},gtouchstart(t,e){var s=this;return this.timeOutEvent=setTimeout((function(){s.longPress(t,e)}),500),!1},showDeleteButton(t){return clearTimeout(this.timeOutEvent),0!=this.timeOutEvent&&console.log("点击但未长按"),!1},gtouchmove(){clearTimeout(this.timeOutEvent),this.timeOutEvent=0},async longPress(e,i){this.timeOutEvent=0;var o=this;o.num=e,o.ques_user=i,console.log(o.num),s({title:"确认删除提问",content:"请确认是否删除这条提问",success:async function(e){if(e.confirm){let e={q_id:o.num,user_id:t("login_id")};console.log(e),await o.$u.post("student_user/delete_question",e),o.$u.toast("删除成功")}else e.cancel}})}},onLoad(){this.getQuestions()},onPullDownRefresh(){console.log("refresh"),this.getQuestions(),setTimeout((function(){i()}),1e3)},onBackPress(t){console.log(t),"backbutton"==t.from&&setTimeout((()=>{this.$u.route("/pages/teacher_class/teacher_class")}),500)}},[["render",function(t,e,s,i,g,$){const T=k(_("uni-tag"),f),x=q,C=p,j=k(_("uni-icons"),y),E=k(_("uni-card"),b),O=k(_("uni-easyinput"),w),Q=k(_("u-button"),v);return o(),n(a,null,[(o(!0),n(a,null,u(g.questions,((t,s)=>(o(),d(E,{title:t.q_name+" 提问","sub-title":t.q_user,extra:t.q_time,thumbnail:g.ques_avatar,onTouchstart:e=>$.gtouchstart(t.q_id,t.q_user),onTouchmove:e[0]||(e[0]=t=>$.gtouchmove()),onTouchend:e=>$.showDeleteButton(t.q_id)},{default:c((()=>[l(x,{class:"tag-view"},{default:c((()=>["1"==t.q_user[0]?(o(),d(T,{key:0,text:"老师提问",type:"primary",circle:!0})):h("",!0)])),_:2},1024),l(C,{class:"uni-body"},{default:c((()=>[r(m(t.q_con),1)])),_:2},1024),l(x,{slot:"actions",class:"card-actions"},{default:c((()=>[l(x,{class:"card-actions-item"},{default:c((()=>[t.hasliked?t.hasliked?(o(),d(j,{key:1,type:"heart-filled",size:"18",color:"#ff0000",onClick:e=>$.dislike_it(t.q_id,s)},null,8,["onClick"])):h("",!0):(o(),d(j,{key:0,type:"heart",size:"18",color:"#999",onClick:e=>$.like_it(t.q_id,s)},null,8,["onClick"])),l(C,{class:"card-actions-item-text"},{default:c((()=>[r(m(t.q_like),1)])),_:2},1024)])),_:2},1024),l(x,{class:"card-actions-item",onClick:e=>$.to_answer(t.q_id)},{default:c((()=>[l(j,{type:"chatbubble",size:"18",color:"#999"}),l(C,{class:"card-actions-item-text"},{default:c((()=>[r("回答")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["title","sub-title","extra","thumbnail","onTouchstart","onTouchend"])))),256)),l(E,null,{default:c((()=>[l(O,{type:"textarea",modelValue:g.new_ques,"onUpdate:modelValue":e[1]||(e[1]=t=>g.new_ques=t),placeholder:"我也要提问...."},null,8,["modelValue"]),l(Q,{onClick:$.send,type:"primary"},{default:c((()=>[r("发送")])),_:1},8,["onClick"])])),_:1})],64)}],["__scopeId","data-v-637d024d"]]);export{$ as default};
